---
author: joshua-auchincloss
components:
  - cli
created: 2025-12-26
kind: ERR
number: 16
status: draft
title: CLI Errors
updates:
  - author: joshua-auchincloss
    date: 2025-12-26
    description: Removed browser auth errors (KCL1001, KCL1002), removed KCL4002 (yank is permanent)
  - author: joshua-auchincloss
    date: 2025-12-26
    description: Created specification
version_after: 0.1.0
version_before: null
---

# ERR-0016: CLI Errors

## Overview

This specification defines the KCL (Kintsu Command Line) error domain, covering all errors specific to CLI command execution, authentication flows, publishing, and scaffolding operations.

## Domain Summary

### Resolution Errors

| Code    | Name            | Severity | Category   |
| ------- | --------------- | -------- | ---------- |
| KCL1001 | TokenAuthFailed | Error    | Resolution |

### Validation Errors

| Code    | Name               | Severity | Category   |
| ------- | ------------------ | -------- | ---------- |
| KCL2001 | PackageNotInDeps   | Error    | Validation |
| KCL2002 | InvalidCommandArg  | Error    | Validation |
| KCL2003 | MissingRequiredArg | Error    | Validation |

### Conflict Errors

| Code    | Name               | Severity | Category |
| ------- | ------------------ | -------- | -------- |
| KCL3001 | UncommittedChanges | Error    | Conflict |
| KCL3002 | PackageTooLarge    | Error    | Conflict |
| KCL3003 | VerificationFailed | Error    | Conflict |

### State Errors

| Code    | Name                 | Severity | Category |
| ------- | -------------------- | -------- | -------- |
| KCL4001 | VersionAlreadyYanked | Error    | State    |

### Scaffolding Errors

| Code    | Name                 | Severity | Category    |
| ------- | -------------------- | -------- | ----------- |
| KCL5001 | TargetAlreadyExists  | Error    | Scaffolding |
| KCL5002 | InvalidPackageName   | Error    | Scaffolding |
| KCL5003 | CannotWriteDirectory | Error    | Scaffolding |
| KCL5004 | TemplateNotFound     | Error    | Scaffolding |

---

## Error Definitions

### KCL1001: TokenAuthFailed

**Severity:** Error
**Phase:** Authentication

**Message:**

```text title="KCL1001 message"
authentication failed: {reason}
```

**Primary Span:** N/A

**Help:** Check your token and try again.

**Example:**

```text title="KCL1001 example (expired token)"
error[KCL1001]: authentication failed: invalid or expired token
   |
   = help: tokens expire after 90 days of inactivity
   = help: generate a new token at https://registry.kintsu.dev/settings/tokens
   = help: then run `kintsu login` to enter the new token
```

```text title="KCL1001 example (insufficient scopes)"
error[KCL1001]: authentication failed: token rejected by registry
   |
   = note: the registry returned: insufficient scopes
   = help: ensure your token has the required permissions
```

**References:** [RFC-0026](/specs/rfc/RFC-0026) (CLI Authentication Commands)

---

### KCL2001: PackageNotInDeps

**Severity:** Error
**Phase:** Command Execution

**Message:**

```text title="KCL2001 message"
package '{name}' not found in dependencies
```

**Primary Span:** N/A

**Help:** Check the package name or add it first with `kintsu add`.

**Example:**

```text title="KCL2001 example"
error[KCL2001]: package 'common-types' not found in dependencies
   |
   = help: did you mean 'common-utils'?
   = help: or add it first with `kintsu add common-types`
```

**References:** [RFC-0025](/specs/rfc/RFC-0025) (CLI Dependency Commands)

---

### KCL2002: InvalidCommandArg

**Severity:** Error
**Phase:** Argument Parsing

**Message:**

```text title="KCL2002 message"
invalid argument '{arg}': {reason}
```

**Primary Span:** N/A

**Help:** Check command syntax with `kintsu help <command>`.

**Example:**

```text title="KCL2002 example"
error[KCL2002]: invalid argument '--registry': expected value
   |
   = help: use `--registry <NAME>` with a registry name
   = help: see `kintsu help add` for usage
```

**References:** N/A

---

### KCL2003: MissingRequiredArg

**Severity:** Error
**Phase:** Argument Parsing

**Message:**

```text title="KCL2003 message"
missing required argument: {arg}
```

**Primary Span:** N/A

**Help:** Provide the required argument.

**Example:**

```text title="KCL2003 example"
error[KCL2003]: missing required argument: <PACKAGE>
   |
   = help: usage: kintsu add <PACKAGE>...
   = help: see `kintsu help add` for more information
```

**References:** N/A

---

### KCL3001: UncommittedChanges

**Severity:** Error
**Phase:** Pre-publish Verification

**Message:**

```text title="KCL3001 message"
working directory has uncommitted changes
```

**Primary Span:** N/A

**Help:** Commit changes or use `--allow-dirty`.

**Example:**

```text title="KCL3001 example"
error[KCL3001]: working directory has uncommitted changes
   |
   = note: modified files:
   =   schema/types.ks
   =   schema.toml
   = help: commit your changes before publishing
   = help: or use `--allow-dirty` to publish anyway
```

**References:** [RFC-0028](/specs/rfc/RFC-0028) (CLI Publishing Commands)

---

### KCL3002: PackageTooLarge

**Severity:** Error
**Phase:** Packaging

**Message:**

```text title="KCL3002 message"
package size {size} exceeds maximum {limit}
```

**Primary Span:** N/A

**Help:** Reduce package size by excluding unnecessary files.

**Example:**

```text title="KCL3002 example"
error[KCL3002]: package size 15.2 MB exceeds maximum 10 MB
   |
   = note: largest files:
   =   schema/generated.ks    8.5 MB
   =   schema/data.ks         4.2 MB
   = help: add large files to [package.exclude]
   = help: or split into multiple packages
```

**References:** [RFC-0028](/specs/rfc/RFC-0028) (CLI Publishing Commands)

---

### KCL3003: VerificationFailed

**Severity:** Error
**Phase:** Pre-publish Verification

**Message:**

```text title="KCL3003 message"
pre-publish verification failed
```

**Primary Span:** Varies

**Help:** Fix the issues before publishing.

**Example:**

```text title="KCL3003 example"
error[KCL3003]: pre-publish verification failed
   |
   = note: schema compilation failed
   = help: run `kintsu check` to see errors
   = help: or use `--no-verify` to skip verification (not recommended)
```

**References:** [RFC-0028](/specs/rfc/RFC-0028) (CLI Publishing Commands)

---

### KCL4001: VersionAlreadyYanked

**Severity:** Error
**Phase:** Registry Operation

**Message:**

```text title="KCL4001 message"
version '{version}' is already yanked
```

**Primary Span:** N/A

**Help:** Yanking is permanent. Publish a new version with the fix.

**Example:**

```text title="KCL4001 example"
error[KCL4001]: version '2.3.0' is already yanked
   |
   = note: yanking is permanent and cannot be undone
   = help: publish a new version with `kintsu publish`
```

**References:** [RFC-0028](/specs/rfc/RFC-0028) (CLI Publishing Commands)

---

### KCL5001: TargetAlreadyExists

**Severity:** Error
**Phase:** Scaffolding

**Message:**

```text title="KCL5001 message"
{target} already exists
```

**Primary Span:** N/A

**Help:** Choose a different name or remove the existing target.

**Example:**

```text title="KCL5001 example (directory)"
error[KCL5001]: directory 'my-types' already exists
   |
   = help: choose a different name
   = help: or remove the existing directory first
```

```text title="KCL5001 example (schema.toml)"
error[KCL5001]: schema.toml already exists
   |
   = help: cannot initialize in a directory with existing schema.toml
   = help: use a different directory
```

**References:** [RFC-0029](/specs/rfc/RFC-0029) (CLI Scaffolding Commands)

---

### KCL5002: InvalidPackageName

**Severity:** Error
**Phase:** Scaffolding

**Message:**

```text title="KCL5002 message"
invalid package name '{name}': {reason}
```

**Primary Span:** N/A

**Help:** Use lowercase letters, numbers, and hyphens only.

**Example:**

```text title="KCL5002 example (uppercase)"
error[KCL5002]: invalid package name 'My_Types': uppercase not allowed
   |
   = help: use lowercase with hyphens: 'my-types'
```

```text title="KCL5002 example (number start)"
error[KCL5002]: invalid package name '1types': must start with letter
   |
   = help: try 'types-1' or 'one-types'
```

**References:** [RFC-0029](/specs/rfc/RFC-0029) (CLI Scaffolding Commands)

---

### KCL5003: CannotWriteDirectory

**Severity:** Error
**Phase:** Scaffolding

**Message:**

```text title="KCL5003 message"
cannot write to directory '{path}': {reason}
```

**Primary Span:** N/A

**Help:** Check directory permissions or choose a different location.

**Example:**

```text title="KCL5003 example"
error[KCL5003]: cannot write to directory '/opt/schemas': permission denied
   |
   = help: check directory permissions
   = help: or use a different path with `--path`
```

**References:** [RFC-0029](/specs/rfc/RFC-0029) (CLI Scaffolding Commands)

---

### KCL5004: TemplateNotFound

**Severity:** Error
**Phase:** Scaffolding

**Message:**

```text title="KCL5004 message"
template '{name}' not found
```

**Primary Span:** N/A

**Help:** List available templates or check the template path.

**Example:**

```text title="KCL5004 example"
error[KCL5004]: template 'api-service' not found
   |
   = note: available templates: default, lib, workspace
   = help: check ~/.config/kintsu/templates/ for custom templates
```

**References:** [RFC-0029](/specs/rfc/RFC-0029) (CLI Scaffolding Commands)

---

## Exit Codes

All CLI errors map to exit codes:

| Code Range | Category                  |
| ---------- | ------------------------- |
| 0          | Success                   |
| 1          | General/unspecified error |
| 2          | Invalid arguments         |
| 3          | File/directory errors     |
| 4          | Network errors            |
| 5          | Authentication errors     |
| 6          | Publishing errors         |

## References

- [RFC-0025](/specs/rfc/RFC-0025) - CLI Dependency Commands
- [RFC-0026](/specs/rfc/RFC-0026) - CLI Authentication Commands
- [RFC-0027](/specs/rfc/RFC-0027) - CLI Inspection Commands
- [RFC-0028](/specs/rfc/RFC-0028) - CLI Publishing Commands
- [RFC-0029](/specs/rfc/RFC-0029) - CLI Scaffolding Commands
- [ERR-0001](/specs/err/ERR-0001) - Error System Overview
