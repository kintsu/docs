---
author: joshua-auchincloss
components:
  - compiler
created: 2025-12-25
kind: ERR
number: 8
status: draft
title: Metadata Errors
updates:
  - author: joshua-auchincloss
    date: 2025-12-25
    description: Created specification
version_after: 0.1.0
version_before: null
---

# ERR-0008: Metadata Errors

## Overview

This specification defines the KMT (Kintsu MeTadata) error domain, covering all errors related to version attributes, error attributes, and other metadata in Kintsu schema files.

## Domain Summary

| Code    | Name                   | Severity | Category      |
| ------- | ---------------------- | -------- | ------------- |
| KMT3001 | VersionConflict        | Error    | Conflict      |
| KMT3002 | DuplicateMetaAttribute | Error    | Conflict      |
| KMT6001 | VersionIncompatibility | Error    | Compatibility |
| KMT2001 | InvalidVersionValue    | Error    | Validation    |
| KMT2002 | InvalidErrorAttribute  | Error    | Validation    |

---

## Error Definitions

### KMT3001: VersionConflict

**Severity:** Error
**Phase:** Parsing

**Message:**

```
version attribute conflict: values={values}
```

**Primary Span:** The conflicting version attribute

**Related Spans:** All version attribute locations with their values

**Help:** An item can only have one version attribute. Remove duplicate version declarations.

**Example:**

```
error[KMT3001]: version attribute conflict: values=[1, 2]
  --> schema/models.ks:3:1
   |
 1 | #[version(1)]
   | ------------- first version attribute
 2 | #[version(2)]
   | ^^^^^^^^^^^^^ conflicting version attribute
 3 | struct User {
   |
   = help: remove one of the version attributes
```

**References:** [TSY-0011](/specs/tsy/tsy-0011) (Metadata Syntax), [SPEC-0012](/specs/spec/spec-0012) (Metadata Resolution)

---

### KMT3002: DuplicateMetaAttribute

**Severity:** Error
**Phase:** Parsing

**Message:**

```
{attribute} attribute is declared multiple times in {path}
```

**Primary Span:** The duplicate attribute

**Related Spans:** The first attribute declaration

**Help:** Each metadata attribute type can only appear once per item or namespace.

**Example:**

```
error[KMT3002]: err attribute is declared multiple times in schema/api/lib.ks
  --> schema/api/lib.ks:3:1
   |
 1 | #![err(ApiError)]
   | ----------------- first declaration
   |
 3 | #![err(OtherError)]
   | ^^^^^^^^^^^^^^^^^^^ duplicate declaration
   |
   = help: remove the duplicate attribute or combine error types
```

**References:** [TSY-0011](/specs/tsy/tsy-0011) (Metadata Syntax), [SPEC-0012](/specs/spec/spec-0012) (Metadata Resolution)

---

### KMT6001: VersionIncompatibility

**Severity:** Error
**Phase:** Resolution

**Message:**

```
version incompatibility: {package} requires version {required}, but found {found}
```

**Primary Span:** The dependency declaration or version requirement

**Help:** Update the dependency version to match the requirement, or update your package to be compatible.

**Example:**

```
error[KMT6001]: version incompatibility: external_api requires version ^2.0.0, but found 1.5.0
  --> kintsu.toml:5:1
   |
 5 | external_api = "1.5.0"
   | ^^^^^^^^^^^^^^^^^^^^^^ incompatible version
   |
   = help: update to `external_api = "^2.0.0"`
```

**References:** [SPEC-0015](/specs/spec/spec-0015) (Package Manifest)

---

### KMT2001: InvalidVersionValue

**Severity:** Error
**Phase:** Parsing

**Message:**

```
invalid version value: expected positive integer, found {value}
```

**Primary Span:** The invalid version value

**Help:** Version attributes must be positive integers (1, 2, 3, ...).

**Example:**

```
error[KMT2001]: invalid version value: expected positive integer, found 0
  --> schema/models.ks:1:11
   |
 1 | #[version(0)]
   |           ^ version must be positive
   |
   = help: version values start at 1
```

**References:** [TSY-0011](/specs/tsy/tsy-0011) (Metadata Syntax)

---

### KMT2002: InvalidErrorAttribute

**Severity:** Error
**Phase:** Parsing, Resolution

**Message:**

```
invalid error attribute: {reason}
```

**Primary Span:** The invalid error attribute

**Help:** The error attribute must reference a valid error type defined in the schema.

**Example:**

```
error[KMT2002]: invalid error attribute: 'NotAnError' is not an error type
  --> schema/api/handlers.ks:1:6
   |
 1 | #[err(NotAnError)]
   |       ^^^^^^^^^^ expected error type
   |
   = help: define an error type with `error NotAnError { ... }`
   = help: or reference an existing error type
```

**References:** [TSY-0011](/specs/tsy/tsy-0011) (Metadata Syntax), [TSY-0005](/specs/tsy/tsy-0005) (Error Types)

---

## Design Notes

### Metadata Inheritance

Kintsu supports namespace-level metadata inheritance through inner attributes:

- `#![version(n)]` - Sets default version for all items in namespace
- `#![err(Type)]` - Sets default error type for operations in namespace

Item-level attributes override namespace-level defaults. See [SPEC-0012](/specs/spec/spec-0012) for resolution rules.

### Version Semantics

Version numbers in Kintsu represent schema evolution:

- Must be positive integers
- Higher versions indicate newer schema revisions
- Used for backwards compatibility checking

## References

- [RFC-0023](/specs/rfc/rfc-0023) - Error Handling Design
- [SPEC-0022](/specs/spec/spec-0022) - Error System Architecture
- [ERR-0001](/specs/err/err-0001) - Error System Overview
- [TSY-0011](/specs/tsy/tsy-0011) - Metadata Syntax
- [TSY-0005](/specs/tsy/tsy-0005) - Error Types
- [SPEC-0012](/specs/spec/spec-0012) - Metadata Resolution
