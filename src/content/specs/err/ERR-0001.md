---
author: joshua-auchincloss
components:
  - compiler
  - parser
created: 2025-12-25
kind: ERR
number: 1
status: draft
title: Error System Overview
updates:
  - author: joshua-auchincloss
    date: 2025-12-25
    description: Created specification
version_after: 0.1.0
version_before: null
---

# ERR-0001: Error System Overview

## Overview

This specification provides the authoritative registry of all Kintsu error domains and serves as the entry point for the error handling system. It defines the complete domain taxonomy, severity level semantics, and cross-reference index to individual domain specifications.

For the design rationale, see [RFC-0023](/specs/rfc/rfc-0023). For implementation details, see [SPEC-0022](/specs/spec/spec-0022).

## Error Code Format

All Kintsu error codes follow the format:

```
K[Domain][Category][Sequence]
```

| Component  | Format    | Description                  |
| ---------- | --------- | ---------------------------- |
| `K`        | 1 letter  | Kintsu prefix                |
| `Domain`   | 2 letters | Error domain identifier      |
| `Category` | 1 digit   | Error category within domain |
| `Sequence` | 3 digits  | Sequence number (001-999)    |

**Example:** `KTR1001` = Kintsu Type Resolution, Resolution category, error 001

## Domain Registry

| Code | Domain          | ERR Spec                        | Description                                 |
| ---- | --------------- | ------------------------------- | ------------------------------------------- |
| `LX` | Lexical         | [ERR-0002](/specs/err/err-0002) | Token formation from raw text               |
| `PR` | Parsing         | [ERR-0003](/specs/err/err-0003) | AST construction from tokens                |
| `NS` | Namespace       | [ERR-0004](/specs/err/err-0004) | Namespace declaration and organisation      |
| `TY` | Type Definition | [ERR-0005](/specs/err/err-0005) | Struct, enum, error, oneof declarations     |
| `TR` | Type Resolution | [ERR-0006](/specs/err/err-0006) | Reference resolution, alias handling        |
| `UN` | Union           | [ERR-0007](/specs/err/err-0007) | Union (`&`) and Union Or (`&\|`) operations |
| `MT` | Metadata        | [ERR-0008](/specs/err/err-0008) | Version and error attributes                |
| `TG` | Tagging         | [ERR-0009](/specs/err/err-0009) | Variant tagging styles                      |
| `TE` | Type Expression | [ERR-0010](/specs/err/err-0010) | Pick, Omit, Partial operators               |
| `PK` | Package         | [ERR-0011](/specs/err/err-0011) | Manifest and lockfile                       |
| `RG` | Registry        | [ERR-0012](/specs/err/err-0012) | Client/server API operations                |
| `FS` | Filesystem      | [ERR-0013](/specs/err/err-0013) | File read/write operations                  |
| `IN` | Internal        | [ERR-0014](/specs/err/err-0014) | Compiler internal errors                    |

## Category Definitions

Within each domain, the category digit groups errors by their nature:

| Digit | Category      | Description                          | Example                                     |
| ----- | ------------- | ------------------------------------ | ------------------------------------------- |
| `0`   | Syntax        | Syntactic or structural malformation | `KPR0001`: Expected token not found         |
| `1`   | Resolution    | Name or reference resolution failure | `KTR1001`: Type not found                   |
| `2`   | Validation    | Semantic constraint violation        | `KTG2001`: Tag field conflicts with variant |
| `3`   | Conflict      | Duplicate or collision detected      | `KTY3001`: Duplicate type definition        |
| `4`   | Missing       | Required element is absent           | `KMT4001`: Missing error type attribute     |
| `5`   | Cycle         | Circular dependency detected         | `KTR5001`: Circular type alias              |
| `6`   | Compatibility | Version or format incompatibility    | `KPK6001`: Incompatible package version     |
| `7`   | Reserved      | Future use                           | -                                           |
| `8`   | Warning       | Non-fatal issue                      | `KTY8001`: Shadowed field                   |
| `9`   | Internal      | Internal implementation error        | `KIN9001`: Lock poisoned                    |

## Severity Levels

| Level       | Code Suffix       | Compilation | CLI Output       | IDE Output   |
| ----------- | ----------------- | ----------- | ---------------- | ------------ |
| **Error**   | Categories 0-6, 9 | Fails       | Always shown     | Always shown |
| **Warning** | Category 8        | Succeeds    | Always shown     | Always shown |
| **Info**    | Explicit          | Succeeds    | `--verbose` only | Shown        |
| **Hint**    | Explicit          | Succeeds    | Never            | Shown        |

### Severity Behaviour

**Error**: Compilation terminates. The error must be resolved before proceeding.

**Warning**: Compilation succeeds but the issue should be addressed. Warnings may become errors in future versions.

**Info**: Supplementary diagnostic information. Useful for understanding compiler decisions but not actionable.

**Hint**: IDE-specific guidance for code quality. Not shown in CLI output to avoid noise.

## Error Code Ranges

Each domain reserves code ranges for future expansion:

| Domain | Range Start | Range End | Allocated |
| ------ | ----------- | --------- | --------- |
| KLX    | KLX0001     | KLX9999   | ~10       |
| KPR    | KPR0001     | KPR9999   | ~15       |
| KNS    | KNS0001     | KNS9999   | ~10       |
| KTY    | KTY0001     | KTY9999   | ~20       |
| KTR    | KTR0001     | KTR9999   | ~15       |
| KUN    | KUN0001     | KUN9999   | ~5        |
| KMT    | KMT0001     | KMT9999   | ~10       |
| KTG    | KTG0001     | KTG9999   | ~10       |
| KTE    | KTE0001     | KTE9999   | ~20       |
| KPK    | KPK0001     | KPK9999   | ~15       |
| KRG    | KRG0001     | KRG9999   | ~10       |
| KFS    | KFS0001     | KFS9999   | ~5        |
| KIN    | KIN0001     | KIN9999   | ~5        |

## Compilation Phase Mapping

Errors are associated with one or more compilation phases:

| Phase          | Domains       | Description                           |
| -------------- | ------------- | ------------------------------------- |
| Lexing         | KLX           | Character-to-token conversion         |
| Parsing        | KPR, KNS, KTY | Token-to-AST construction             |
| Resolution 1-2 | KTY           | Anonymous struct extraction, union ID |
| Resolution 3   | KTR           | Type alias resolution                 |
| Resolution 4   | KUN           | Union validation                      |
| Resolution 5   | KUN           | Union field merging                   |
| Resolution 6-7 | KMT           | Version/error metadata                |
| Resolution 8   | KTR           | Type reference validation             |
| Registration   | KTR, KTY      | Type registry population              |
| Configuration  | KPK           | Manifest/lockfile processing          |
| Runtime        | KRG, KFS      | Client/server operations              |

## Design Principles

### Single Source of Truth

All error codes, messages, and diagnostic requirements are defined in ERR specifications. Feature specifications (TSY, SPEC) define **what validations occur** and reference ERR specs for **how failures are reported**.

### Consistency Over Brevity

Error codes use fixed-width format (`K` + 2 + 1 + 3 = 7 characters) even when shorter codes would suffice. This enables pattern matching and tooling.

### Actionable Diagnostics

Every error must provide help text that tells the user **what to do**, not just **what's wrong**.

### Progressive Disclosure

- **Error message**: Brief description of what failed
- **Primary span**: Where the error occurred
- **Help text**: How to fix it
- **Related spans**: Additional context (optional)
- **Suggestions**: Specific fixes (optional)

## Implications

### For Specification Authors

When defining validations in TSY/SPEC documents, reference the appropriate ERR specification rather than defining error codes inline.

### For Compiler Implementers

Each error variant must implement `error_code()` returning the appropriate K-prefixed code. See [SPEC-0022](/specs/spec/spec-0022) for implementation details.

### For Tooling Authors

Error codes are stable identifiers. Tools may rely on code format for filtering, grouping, and documentation linking.

## References

- [RFC-0023](/specs/rfc/rfc-0023) - Error Handling Design
- [SPEC-0022](/specs/spec/spec-0022) - Error System Architecture
- [ERR-0002](/specs/err/err-0002) - Lexical Errors (KLX)
- [ERR-0003](/specs/err/err-0003) - Parsing Errors (KPR)
- [ERR-0004](/specs/err/err-0004) - Namespace Errors (KNS)
- [ERR-0005](/specs/err/err-0005) - Type Definition Errors (KTY)
- [ERR-0006](/specs/err/err-0006) - Type Resolution Errors (KTR)
- [ERR-0007](/specs/err/err-0007) - Union Errors (KUN)
- [ERR-0008](/specs/err/err-0008) - Metadata Errors (KMT)
- [ERR-0009](/specs/err/err-0009) - Tagging Errors (KTG)
- [ERR-0010](/specs/err/err-0010) - Type Expression Errors (KTE)
- [ERR-0011](/specs/err/err-0011) - Package Errors (KPK)
- [ERR-0012](/specs/err/err-0012) - Registry Errors (KRG)
- [ERR-0013](/specs/err/err-0013) - Filesystem Errors (KFS)
- [ERR-0014](/specs/err/err-0014) - Internal Errors (KIN)
