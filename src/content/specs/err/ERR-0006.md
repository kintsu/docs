---
author: joshua-auchincloss
components:
  - compiler
created: 2025-12-25
kind: ERR
number: 6
status: draft
title: Type Resolution Errors
updates:
  - author: joshua-auchincloss
    date: 2025-12-25
    description: Created specification
version_after: 0.1.0
version_before: null
---

# ERR-0006: Type Resolution Errors

## Overview

This specification defines the KTR (Kintsu Type Resolution) error domain, covering all errors related to resolving type references, aliases, and dependencies during compilation.

## Domain Summary

| Code    | Name                     | Severity | Category   |
| ------- | ------------------------ | -------- | ---------- |
| KTR1001 | ResolutionError          | Error    | Resolution |
| KTR1002 | UndefinedType            | Error    | Resolution |
| KTR1003 | UnresolvedType           | Error    | Resolution |
| KTR5001 | CircularDependency       | Error    | Cycle      |
| KTR5002 | SchemaCircularDependency | Error    | Cycle      |
| KTR5003 | CircularAlias            | Error    | Cycle      |

---

## Error Definitions

### KTR1001: ResolutionError

**Severity:** Error
**Phase:** Resolution

**Message:**

```
resolution error. could not resolve '{path}'
```

**Primary Span:** The unresolved path reference

**Help:** Check that the referenced type exists and is accessible from the current namespace. Verify import statements.

**Example:**

```
error[KTR1001]: resolution error. could not resolve 'models::User'
  --> schema/api/handlers.ks:5:15
   |
 5 |     user: models::User,
   |           ^^^^^^^^^^^^ cannot resolve type path
   |
   = help: ensure `models::User` is defined and imported
   = help: add `use models;` to import the namespace
```

**References:** [SPEC-0011](/specs/spec/spec-0011) (Type Resolution)

---

### KTR1002: UndefinedType

**Severity:** Error
**Phase:** Resolution

**Message:**

```
undefined type: '{name}'
```

**Primary Span:** The undefined type reference

**Help:** The type name is not defined anywhere in the schema. Check spelling or define the type.

**Example:**

```
error[KTR1002]: undefined type: 'Usr'
  --> schema/api/handlers.ks:5:10
   |
 5 |     user: Usr,
   |           ^^^ undefined type
   |
   = help: did you mean `User`?
   = help: define the type or check the spelling
```

**References:** [SPEC-0010](/specs/spec/spec-0010) (Type Registry)

---

### KTR1003: UnresolvedType

**Severity:** Error
**Phase:** Resolution

**Message:**

```
unresolved type: '{name}'
```

**Primary Span:** The unresolved type reference

**Help:** The type could not be resolved after all resolution passes. This may indicate a complex dependency issue.

**Example:**

```
error[KTR1003]: unresolved type: 'external::Config'
  --> schema/services/app.ks:3:12
   |
 3 |     config: external::Config,
   |             ^^^^^^^^^^^^^^^^ type could not be resolved
   |
   = help: check that the external package is in your dependencies
   = help: verify the type path is correct
```

**References:** [SPEC-0011](/specs/spec/spec-0011) (Type Resolution)

---

### KTR5001: CircularDependency

**Severity:** Error
**Phase:** Compilation

**Message:**

```
circular dependency detected: {chain...}
```

Where `{chain...}` is the dependency chain joined by `->`.

**Primary Span:** The reference that completes the cycle

**Related Spans:** Each item in the dependency chain

**Help:** Break the circular dependency by restructuring your schemas or using forward references.

**Example:**

```
error[KTR5001]: circular dependency detected: api -> models -> api
  --> schema/models/lib.ks:2:1
   |
   = note: api/lib.ks imports models
   = note: models/lib.ks imports api
   |
 2 | use api;
   | ^^^^^^^^ completes the cycle
   |
   = help: restructure to break the circular import
```

**References:** [SPEC-0007](/specs/spec/spec-0007) (Namespace Compilation)

---

### KTR5002: SchemaCircularDependency

**Severity:** Error
**Phase:** Compilation

**Message:**

```
circular schema dependency detected: {schemas...}
```

Where `{schemas...}` is the schema dependency chain joined by `->`.

**Primary Span:** The schema file that completes the cycle

**Related Spans:** Each schema in the dependency chain

**Help:** Reorganise your schema files to eliminate the circular import relationship.

**Example:**

```
error[KTR5002]: circular schema dependency detected: user.ks -> profile.ks -> user.ks
  --> schema/profile.ks:5:1
   |
   = note: user.ks references types from profile.ks
   = note: profile.ks references types from user.ks
   |
 5 | use user::User;
   | ^^^^^^^^^^^^^^^ completes the cycle
   |
   = help: consider merging related types or introducing an intermediate schema
```

**References:** [SPEC-0007](/specs/spec/spec-0007) (Namespace Compilation)

---

### KTR5003: CircularAlias

**Severity:** Error
**Phase:** Resolution

**Message:**

```
circular alias detected: {chain...}
```

Where `{chain...}` is the alias chain joined by `->`.

**Primary Span:** The alias that completes the cycle

**Related Spans:** Each alias in the chain

**Help:** Type aliases cannot form cycles. Break the cycle by referencing a concrete type.

**Example:**

```
error[KTR5003]: circular alias detected: A -> B -> C -> A
  --> schema/types.ks:7:1
   |
 1 | type A = B;
   | ----------- alias A points to B
   |
 4 | type B = C;
   | ----------- alias B points to C
   |
 7 | type C = A;
   | ^^^^^^^^^^^ alias C points back to A
   |
   = help: break the cycle by making one alias point to a concrete type
```

**References:** [TSY-0008](/specs/tsy/tsy-0008) (Alias Syntax), [SPEC-0011](/specs/spec/spec-0011) (Type Resolution)

---

## References

- [RFC-0023](/specs/rfc/rfc-0023) - Error Handling Design
- [SPEC-0022](/specs/spec/spec-0022) - Error System Architecture
- [ERR-0001](/specs/err/err-0001) - Error System Overview
- [TSY-0008](/specs/tsy/tsy-0008) - Alias Syntax
- [SPEC-0010](/specs/spec/spec-0010) - Type Registry
- [SPEC-0011](/specs/spec/spec-0011) - Type Resolution
